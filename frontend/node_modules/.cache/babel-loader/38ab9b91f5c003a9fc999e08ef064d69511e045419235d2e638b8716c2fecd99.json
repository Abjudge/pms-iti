{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nconst initialState = {\n  tokens: {\n    refresh: localStorage.getItem('Tokens') ? await JSON.parse(localStorage.getItem('Tokens')).refresh : null,\n    access: localStorage.getItem('Tokens') ? JSON.parse(localStorage.getItem('Tokens')).access : null\n  },\n  user: {},\n  full: false,\n  auth: false,\n  // updateTokensfun: {},\n  running_interval: {},\n  loggedin: false,\n  constant: \"\"\n};\n\n// export const getTokens = createAsyncThunk(\"getTokens\", async () => {\n//   const { data } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n//     \"email\": \"moustafashahin122@gmail.com\",\n//     \"password\": \"lovelove122@A\"\n\n//   }\n//   );\n//   console.log(data);\n//   // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:23 ~ getTokens ~ data:\", data);\n//   return data;\n// });\n\nexport const refreshTokens = createAsyncThunk(\"refreshTokens\", async refresh => {\n  const {\n    data\n  } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/refresh/\", {\n    \"refresh\": refresh\n  });\n  console.log(\"ðŸš€ ~ file: TokensSlice.jsx:33 ~ refreshTokens ~ data.access:\", data.access);\n  return data;\n});\nconst TokensSlice = createSlice({\n  name: \"Tokens\",\n  initialState,\n  reducers: {\n    setTokens: (state, action) => {\n      const {\n        access,\n        refresh\n      } = action.payload;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens.access = access;\n      state.tokens.refresh = refresh;\n    },\n    logout: (state, action) => {\n      if (state.loggedin) {\n        console.log(\"ðŸš€ ~ file: TokensSlice.jsx:62 ~ state.running_interval:\", state.running_interval);\n        alert(\"interval cleared\");\n        clearInterval(state.running_interval);\n      }\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:67 ~ state.running_interval:\", state.running_interval);\n      localStorage.clear();\n      alert(\"logou\");\n      state.tokens = {};\n      state.auth = false;\n      state.user = {};\n      state.loggedin = false;\n    },\n    setUser: (state, action) => {\n      const {\n        user_id\n      } = action.payload;\n      state.user.user_id = user_id;\n    },\n    updateAuth: (state, action) => {\n      state.auth = action.payload;\n    },\n    setRunningInterval: (state, action) => {\n      if (!state.loggedin) {\n        state.running_interval = action.payload;\n        console.log(\"///////////////////////////////////////////////////////////////////////////////\");\n        console.log(\"ðŸš€ ~ file: TokensSlice.jsx:89 ~ state.running_interval:\", state.running_interval);\n      } else {\n        alert(\"there is another interval running\");\n      }\n    },\n    setLoggedIn: (state, action) => {\n      state.loggedin = true;\n    },\n    setupdateTokensfun: (state, action) => {\n      state.updateTokensfun = action.payload;\n    }\n    // refreshTokens: (state) => {\n    //   state.auth ;\n\n    // },\n  },\n\n  extraReducers: builder => {\n    // builder.addCase(getTokens.fulfilled, (state, action) => {\n    //   state.tokens = action.payload;\n    //   // state.tokens.access = access;\n    //   // state.tokens.refresh = refresh;\n    //   // console.log(\"dssssssssssssssssssssssssssssss\", state.tokens.access);\n    //   state.full = true;\n    // });\n\n    builder.addCase(refreshTokens.fulfilled, (state, action) => {\n      state.tokens.access = action.payload.access;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:88 ~ builder.addCase ~ action.payload.access:\", action.payload.access);\n      console.log(\"*******************************************************************\");\n      state.auth = true;\n      const {\n        user_id\n      } = jwt_decode(state.tokens.access);\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:142 ~ builder.addCase ~ state.tokens.access:\", state.tokens.access);\n      state.user.user_id = user_id;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:89 ~ builder.addCase ~ user_id:\", user_id);\n      state.loggedin = true;\n      state.full = true;\n    });\n    builder.addCase(refreshTokens.rejected, (state, action) => {\n      alert(\"failed to refresh\");\n    });\n  }\n});\nexport const {\n  setTokens,\n  updateAuth,\n  setUser,\n  logout,\n  setupdateTokensfun,\n  setRunningInterval,\n  setLoggedIn\n} = TokensSlice.actions;\nexport default TokensSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","jwt_decode","initialState","tokens","refresh","localStorage","getItem","JSON","parse","access","user","full","auth","running_interval","loggedin","constant","refreshTokens","data","post","console","log","TokensSlice","name","reducers","setTokens","state","action","payload","logout","alert","clearInterval","clear","setUser","user_id","updateAuth","setRunningInterval","setLoggedIn","setupdateTokensfun","updateTokensfun","extraReducers","builder","addCase","fulfilled","rejected","actions","reducer"],"sources":["/home/shahin/GithubU/pms-iti/frontend/src/redux/slices/TokensSlice.jsx"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\n\n\n\n\nconst initialState = {\n  tokens: { refresh: (localStorage.getItem('Tokens') ? await JSON.parse(localStorage.getItem('Tokens')).refresh : null), access: (localStorage.getItem('Tokens') ? JSON.parse(localStorage.getItem('Tokens')).access : null) },\n  user: {},\n  full: false,\n  auth: false,\n  // updateTokensfun: {},\n  running_interval: {},\n  loggedin: false,\n  constant: \"\"\n};\n\n// export const getTokens = createAsyncThunk(\"getTokens\", async () => {\n//   const { data } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n//     \"email\": \"moustafashahin122@gmail.com\",\n//     \"password\": \"lovelove122@A\"\n\n//   }\n//   );\n//   console.log(data);\n//   // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:23 ~ getTokens ~ data:\", data);\n//   return data;\n// });\n\n\n\n\n\n\nexport const refreshTokens = createAsyncThunk(\"refreshTokens\", async (refresh) => {\n\n  const { data } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/refresh/\", {\n    \"refresh\": refresh,\n  }\n  );\n  console.log(\"ðŸš€ ~ file: TokensSlice.jsx:33 ~ refreshTokens ~ data.access:\", data.access);\n  return data;\n\n}\n);\nconst TokensSlice = createSlice({\n  name: \"Tokens\",\n  initialState,\n  reducers: {\n\n\n    setTokens: (state, action) => {\n\n      const { access, refresh } = action.payload;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens.access = access;\n      state.tokens.refresh = refresh;\n    },\n\n    logout: (state, action) => {\n      if (state.loggedin) {\n        console.log(\"ðŸš€ ~ file: TokensSlice.jsx:62 ~ state.running_interval:\", state.running_interval);\n\n        alert(\"interval cleared\");\n\n        clearInterval(state.running_interval);\n      }\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:67 ~ state.running_interval:\", state.running_interval);\n\n      localStorage.clear();\n      alert(\"logou\");\n      state.tokens = {};\n      state.auth = false;\n      state.user = {};\n      state.loggedin = false;\n\n    },\n    setUser: (state, action) => {\n\n      const { user_id } = action.payload;\n      state.user.user_id = user_id;\n\n    },\n    updateAuth: (state, action) => {\n\n      state.auth = action.payload;\n\n\n    },\n    setRunningInterval: (state, action) => {\n      if (!state.loggedin) {\n        state.running_interval = action.payload;\n        console.log(\"///////////////////////////////////////////////////////////////////////////////\");\n        console.log(\"ðŸš€ ~ file: TokensSlice.jsx:89 ~ state.running_interval:\", state.running_interval);\n\n      } else {\n        alert(\"there is another interval running\");\n      }\n\n\n\n    },\n    setLoggedIn: (state, action) => {\n\n      state.loggedin = true;\n\n\n    },\n    setupdateTokensfun: (state, action) => {\n\n      state.updateTokensfun = action.payload;\n\n\n    },\n    // refreshTokens: (state) => {\n    //   state.auth ;\n\n\n    // },\n\n\n  },\n\n  extraReducers: (builder) => {\n    // builder.addCase(getTokens.fulfilled, (state, action) => {\n    //   state.tokens = action.payload;\n    //   // state.tokens.access = access;\n    //   // state.tokens.refresh = refresh;\n    //   // console.log(\"dssssssssssssssssssssssssssssss\", state.tokens.access);\n    //   state.full = true;\n    // });\n\n\n    builder.addCase(refreshTokens.fulfilled, (state, action) => {\n      state.tokens.access = action.payload.access;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:88 ~ builder.addCase ~ action.payload.access:\", action.payload.access);\n      console.log(\"*******************************************************************\");\n      state.auth = true;\n      const { user_id } = jwt_decode(state.tokens.access);\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:142 ~ builder.addCase ~ state.tokens.access:\", state.tokens.access);\n      state.user.user_id = user_id;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:89 ~ builder.addCase ~ user_id:\", user_id);\n      state.loggedin = true; state.full = true;\n\n\n    });\n    builder.addCase(refreshTokens.rejected, (state, action) => {\n\n      alert(\"failed to refresh\");\n    });\n  },\n});\nexport const { setTokens, updateAuth, setUser, logout, setupdateTokensfun, setRunningInterval, setLoggedIn } = TokensSlice.actions;\n\nexport default TokensSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}